<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DamageBDD Execute Feature</title>
    <link rel="stylesheet" type="text/css" href='/static/css/micromodal.css' />
    <link rel="stylesheet" type="text/css" href='/static/css/toast.css' />
    <link rel="stylesheet" type="text/css" href='/static/css/tabby-ui.min.css' />
    <script async src='https://www.googletagmanager.com/gtag/js?id=G-5QG625RHB7'></script>
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
    <style type="text/css">
      body {
          font-family: 'Roboto', sans-serif;
      }
    </style>
    <script src='https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/highlight.min.js'></script>
    <script src="/static/js/three.min.js"></script>
    <script src="/static/js/vanta.globe.min.js"></script>
    <script src="/static/js/qrcode.min.js"></script>
    <script src="/static/js/micromodal.min.js"></script>
    <script src="/static/js/tabby.polyfills.min.js"></script>
    <script src="/static/js/highlight/languages/gherkin.min.js"></script>
    <script src="/static/js/code-input/code-input.min.js"></script>
    <script src="/static/js/code-input/plugins/indent.min.js"></script>
    <script src="/static/js/code-input/plugins/autodetect.min.js"></script>
    <script src="/static/js/code-input/plugins/autocomplete.min.js"></script>
    <script src="/static/js/editor.js"></script>

    <link rel="stylesheet" type="text/css" href='https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/styles/default.min.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/grids-responsive-min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/base-min.css">

    <link rel="stylesheet" type="text/css" href='/static/css/code-input.min.css' />
    <link rel="stylesheet" type="text/css" href='/static/css/autocomplete.min.css' />
    <link rel="stylesheet" type="text/css" href='/static/css/main.css' />
    <meta name="viewport" content="width=device-width, initial-scale=1">



  </head>

  <body>
    <div class="modal micromodal-slide" id="invoice-modal" aria-hidden="true">
      <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
          <header class="modal__header">
            <h2 class="modal__title" id="modal-1-title">
              Purchase Damage Tokens
            </h2>
            <button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
          </header>
          <main class="modal__content" id="modal-1-content">
            <p>
              Buy Damage Tokens to power more tests at higher concurrency and for longer durations.
            <p>
            </p>
            Make a payment using BIP21 compatible wallet, to top up on credits to deal more damage.
            </p>
            <div id="qrcode">
              <form id="invoice-form">
                <label for="totalAmt">Invoice Amount in Sats</label>
                <input type="number" step="1000" id="invoice-amount">
                <button id="generate-invoice-btn">Generate Invoice</button>
              </form>
            </div>
          </main>
          <footer class="modal__footer">
            <button class="modal__btn modal__btn-primary" data-micromodal-close aria-label="Close this dialog window">Close</button>
          </footer>
        </div>
      </div>
    </div>

    <div class="modal micromodal-slide" id="login-modal" aria-hidden="true">
      <div class="modal__overlay" tabindex="-1">
        <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
          <header class="modal__header">
            <h2 class="modal__title" id="modal-1-title">
              DamageBDD Login
            </h2>
          </header>
          <main class="modal__content" id="modal-1-content">
            <form id="loginSignupForm" onsubmit="submitLoginForm(event)">
              <!--<label for="username">Username (Email):</label>-->
              <input type="email" id="login-username" autocomplete="username" required placeholder="Email Address">
              <br>
              <!--<label for="password" >Password:</label>-->
              <input type="password" id="password" autocomplete="current-password" required placeholder="Password">
              <br>
              <button class="buttonlink" id="signupDialogBtn" aria-label="Signup Form.">SignUp</button>
              <button class="buttonlink" id="loginResetPasswdBtn" aria-label="Forgot Password.">Forgot Password</button>
            </form>
          </main>
          <footer class="modal__footer">
            <button id="loginSubmitBtn" class="modal__btn modal__btn-primary" aria-label="Login with email and password">Submit</button>
          </footer>
        </div>
      </div>
    </div>

    <div class="modal micromodal-slide" id="signup-modal" aria-hidden="true">
      <div class="modal__overlay" tabindex="-1">
        <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
          <header class="modal__header">
            <h2 class="modal__title" id="modal-1-title">
              DamageBDD Signup
            </h2>
          </header>
          <main class="modal__content" id="modal-1-content">
            <form id="signupForm" onsubmit="submitSignupForm(event)">
              <!--<label for="username">Username (Email):</label>-->
              <input type="email" id="signup-username" autocomplete="username" required placeholder="Email Address">
              <br>
              <button class="buttonlink" id="loginDialogBtn" aria-label="Login Form.">Login</button>
              <button class="buttonlink" id="signupResetPasswdBtn" aria-label="Forgot Password.">Forgot Password</button>
            </form>
          </main>
          <footer class="modal__footer">
            <button id="signupSubmitBtn" class="modal__btn modal__btn-primary" aria-label="Signup with email and password">Submit</button>
          </footer>
        </div>
      </div>
    </div>
    <div class="modal micromodal-slide" id="logout-modal" aria-hidden="true">
      <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
          <header class="modal__header">
            <h2 class="modal__title" id="modal-1-title">
              Confirm Logout
            </h2>
            <button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
          </header>
          <main class="modal__content" id="modal-1-content">
          </main>
          <footer class="modal__footer">
            <button id="logoutSubmitBtn" class="modal__btn modal__btn-primary" data-micromodal-close aria-label="Logout">Logout</button>
            <button class="modal__btn " data-micromodal-close aria-label="Close this dialog window">Cancel</button>
          </footer>
        </div>
      </div>
    </div>
    <div class="modal micromodal-slide" id="schedule-modal" aria-hidden="true">
      <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
          <header class="modal__header">
            <h2 class="modal__title" id="modal-1-title">
              Add Schedule
            </h2>
            <button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
          </header>
          <main class="modal__content" id="modal-1-content">
            <form id="scheduleForm" onsubmit="submitScheduleForm(event)">
              <!--<label for="username">Username (Email):</label>-->
              <input type="input" id="featurehash"  required placeholder="Feature">
              <br>
              <!--<label for="password" >Password:</label>-->
              <input type="password" id="password" autocomplete="current-password" required placeholder="Password">
              <br>
              <button id="addScheduleBtn" aria-label="Add Schedule">Add Schedule.</button>
            </form>
          </main>
          <footer class="modal__footer">
            <button id="scheduleSubmitBtn" class="modal__btn modal__btn-primary" data-micromodal-close aria-label="Schedule">Schedule</button>
            <button class="modal__btn " data-micromodal-close aria-label="Close this dialog window">Cancel</button>
          </footer>
        </div>
      </div>
    </div>
    <div id="background"></div>
    <div id="content">
      <div id="toolbar">
        <div id="loginBtn" data-micromodal-trigger="login-modal">Login</div>
        <div id="balanceDiv" data-micromodal-trigger="invoice-modal"></div> |
        <div id="logoutBtn" data-micromodal-trigger="logout-modal">Logout </div>
        <!--generate javascript code to make the qrcode modal show when balanceDiv is clicked, and add css to  indicate that balance div is clickable-->
      </div>
      <div class="title">DamageBDD</div>
      <div class="header">The tool to break your stack</div>


      <ul data-tabs>
        <li><a data-tabby-default href="#execution-tab">Execute</a></li>
        <li><a href="#history-tab">History</a></li>
        <li><a href="#analytics-tab">Analytics</a></li>
        <li><a href="#schedules-tab">Schedules</a></li>
        <li><a href="#settings-tab">Settings</a></li>
      </ul>


      <div id="execution-tab" class="execute-container">
        <div class="pure-g">
          <div class="pure-u-1 pure-u-md-1-2">
            <p>
              <div>
                <h3>Create/Edit Feature</h3>
                <p>Write the test case in the textarea below:</p>
                <p>You can find more example test cases <a href="https://github.com/jagguli/DamageBDD/tree/master/features">here</a>:
                </p>
              </div>
              <form id="damageForm">
                <!--<textarea type="text" class="input-box" id="damageInput" placeholder="Enter test case here ..."></textarea>-->
                <div class="container" id="container">
                  <code-input id="damageTextArea" language="gherkin">
Feature: Http test feature
  Scenario: Test post json
    Given I am using server "https://run.staging.damagebdd.com"
    And I set "Content-Type" header to "application/json"
    When I make a POST request to "/tests/"
    """
    {
        "refund_address": "mohjSavDdQYHRYXcS3uS6ttaHP8amyvX78",
        "customer_type": "Individual",
        "full_name": "John Doe",
        "date_of_birth": "1980-01-01",
        "address": "123 Main Street, Sydney, NSW",
        "identification_verification": {
            "document_type": "Passport",
            "document_number": "A1234567"
        },
        "email": "john.doe@damagebdd.com",
        "phone": "0412345678"
    }
    """
    Then the response status must be "201"
    Then the json at path "$.email" must be "john.doe@damagebdd.com"
                  </code-input>
                </div>
                <div id="runsettings">
                  <label for="difficulty">Concurrency:</label>
                  <select id="difficulty">
                    <option value="sk_baby">Im too young to die. (1 rps)</option>
                    <option value="sk_easy">Hey, not too rough. (10 rps)</option>
                    <option value="sk_medium">Hurt me plenty. (100 rps)</option>
                    <option value="sk_hard">Ultra-Violence. (1000 rps)</option>
                    <option value="sk_nightmare">Nightmare! (100000 rps)</option>
                  </select>
                  <br>
                  <br>
                  <label for="duration">Duration:</label>
                  <select id="duration">
                    <option value="sk_baby">Im too young to die. (1 minute)</option>
                    <option value="sk_easy">Hey, not too rough. (10 minutes)</option>
                    <option value="sk_medium">Hurt me plenty. (1 hour)</option>
                    <option value="sk_hard">Ultra-Violence. (10 hours)</option>
                    <option value="sk_nightmare">Nightmare! (1 day)</option>
                  </select>
                  <br>
                  <br>
                  <button type="submit" class="submit-button">Execute Feature</button>
                </div>
              </form>
            </p>
          </div>
          <div class="pure-u-1 pure-u-md-1-2">
            <p>
              <div>
                <h3>Run Report</h3>
                <p>Result of the run will be streamed here.</p>
                <p>You can see previous results in the <a href="#history">history tab</a>.</p>
                <div id="runreports">
                  <ul id="runreports-ul" data-tabs-reports>
                  </ul>
                </div>
              </div>
            </p>
          </div>
        </div>
      </div>

      <div id="history-tab">
        <div id="history">Fetching reports ... </div>
      </div>
      <div id="analytics-tab">
      </div>
      <div id="schedules-tab">
        <button type="button" onclick="MicroModal.show('schedule-modal')">Add Schedule</button>
        <div id="schedules"></div>
      </div>
      <div id="settings-tab">
            <h2  id="modal-1-title">
              Settings
            </h2>
            <form action="submit_settings" method="post">
              <fieldset>
                <legend>DNS Auth Token Settings</legend>
                <button type="button" onclick="generateToken()">Generate Token</button>
                <div id="generatedToken"></div>
              </fieldset>

              <fieldset id="contextVariablesForm">
                <legend>Context Variables Settings</legend>
                <label for="variableName">Name:</label>
                <input type="text" id="variableName" name="variableName" placeholder="Enter variable name">
                <br>
                <label for="value">Value:</label>
                <input type="text" id="value" name="value" placeholder="Enter variable value">
                <br>
                <label for="varType">Type:</label>
                <select id="varType" name="varType">
                  <option value="integer">Integer</option>
                  <option value="float">Float</option>
                  <option value="boolean">Boolean</option>
                  <option value="string">String</option>
                </select>
                <br>
                <label for="variableVisibility">Visibility:</label>
                <select id="variableVisibility" name="variableVisibility">
                  <option value="public">Public</option>
                  <option value="private">Private</option>
                  <option value="obfuscated">Obfuscated</option>
                </select>
                <br>
                <button type="button" onclick="addVariable()">Add Variable</button>
                <div id="contextVariables"></div>
              </fieldset>
              <input type="submit" value="Submit">
            </form>
            <form action="submit_webhook" method="post">
              <fieldset id="contextVariablesForm">
                <legend>Webhooks</legend>
                <label for="variableName">Name:</label>
                <input type="text" id="variableName" name="variableName" placeholder="Enter variable name">
                <br>
                <label for="value">Webhook Url:</label>
                <input type="text" id="value" name="value" placeholder="Enter variable value">
                <br>
                <label for="method">Method:</label>
                <select id="method" name="method">
                  <option value="POST">POST</option>
                  <option value="GET">GET</option>
                </select>
                <br>
                <button type="button" onclick="addWebhook()">Add Webhook</button>
                <div id="contextVariables"></div>
              </fieldset>
              <input type="submit" value="Submit">
            </form>
      </div>
      <script src="/static/js/toasts.js"></script>
      <script src="/static/js/reports.js"></script>
      <script src="/static/js/schedules.js"></script>
      <script src="/static/js/main.js"></script>
  </body>

</html>
